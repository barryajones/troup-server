# Migration `20200624020503-projects-v1`

This migration has been generated by Samrith Shankar at 6/24/2020, 2:05:03 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Project" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"id" SERIAL,"name" text  NOT NULL ,"teamId" integer  NOT NULL ,"updatedAt" timestamp(3)  NOT NULL ,"userId" integer  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Ticket" (
"body" text  NOT NULL ,"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"id" SERIAL,"projectId" integer  NOT NULL ,"sequence" integer  NOT NULL ,"teamId" integer  NOT NULL ,"title" text  NOT NULL ,"updatedAt" timestamp(3)  NOT NULL ,"userId" integer  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Label" (
"background" text  NOT NULL ,"boardId" integer   ,"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"foreground" text  NOT NULL ,"id" SERIAL,"isGlobal" boolean  NOT NULL DEFAULT true,"projectId" integer   ,"teamId" integer  NOT NULL ,"updatedAt" timestamp(3)  NOT NULL ,"value" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."_LabelToProject" (
"A" integer  NOT NULL ,"B" integer  NOT NULL )

CREATE TABLE "public"."_LabelToTicket" (
"A" integer  NOT NULL ,"B" integer  NOT NULL )

CREATE UNIQUE INDEX "_LabelToProject_AB_unique" ON "public"."_LabelToProject"("A","B")

CREATE  INDEX "_LabelToProject_B_index" ON "public"."_LabelToProject"("B")

CREATE UNIQUE INDEX "_LabelToTicket_AB_unique" ON "public"."_LabelToTicket"("A","B")

CREATE  INDEX "_LabelToTicket_B_index" ON "public"."_LabelToTicket"("B")

ALTER TABLE "public"."Ticket" ADD FOREIGN KEY ("projectId")REFERENCES "public"."Project"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_LabelToProject" ADD FOREIGN KEY ("A")REFERENCES "public"."Label"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_LabelToProject" ADD FOREIGN KEY ("B")REFERENCES "public"."Project"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_LabelToTicket" ADD FOREIGN KEY ("A")REFERENCES "public"."Label"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_LabelToTicket" ADD FOREIGN KEY ("B")REFERENCES "public"."Ticket"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200509151001-init..20200624020503-projects-v1
--- datamodel.dml
+++ datamodel.dml
@@ -1,49 +1,90 @@
 datasource db {
-  provider = "postgresql"
-  url = "***"
+    provider = "postgresql"
+    url      = env("DATABASE_URL")
 }
 generator client {
-  provider = "prisma-client-js"
+    provider = "prisma-client-js"
 }
 model Team {
-  id          Int      @default(autoincrement()) @id
-  createdAt   DateTime @default(now())
-  updatedAt   DateTime @updatedAt
-  maxMembers  Int      @default(25)
-  name        String   @unique
-  displayName String?
-  adminEmail  String?
-  owner       User     @relation(fields: [ownerId], references: [id])
-  ownerId     Int
-  members     User[]   @relation("_UsersOnTeam", references: [id])
+    id          Int      @default(autoincrement()) @id
+    createdAt   DateTime @default(now())
+    updatedAt   DateTime @updatedAt
+    maxMembers  Int      @default(25)
+    name        String   @unique
+    displayName String?
+    adminEmail  String?
+    owner       User     @relation("_UserOwnerOfTeams", fields: [ownerId], references: [id])
+    ownerId     Int
+    members     User[]   @relation("_UsersOnTeam", references: [id])
 }
 model User {
-  id          Int         @default(autoincrement()) @id
-  createdAt   DateTime    @default(now())
-  updatedAt   DateTime    @updatedAt
-  email       String      @unique
-  password    String
-  profile     UserProfile
-  memberTeams Team[]      @relation("_UsersOnTeam")
-  ownerTeams  Team[]
+    id          Int         @default(autoincrement()) @id
+    createdAt   DateTime    @default(now())
+    updatedAt   DateTime    @updatedAt
+    email       String      @unique
+    password    String
+    profile     UserProfile
+    memberTeams Team[]      @relation("_UsersOnTeam")
+    ownerTeams  Team[]      @relation("_UserOwnerOfTeams")
 }
 model UserProfile {
-  id                     Int      @default(autoincrement()) @id
-  createdAt              DateTime @default(now())
-  updatedAt              DateTime @updatedAt
-  firstName              String
-  lastName               String
-  isSuperAdmin           Boolean  @default(false)
-  professionalCompetence String?
-  utm_source             String?
-  utm_campaign           String?
-  utm_medium             String?
-  utm_term               String?
-  utm_content            String?
-  user                   User     @relation(fields: [userId], references: [id])
-  userId                 Int
+    id                     Int      @default(autoincrement()) @id
+    createdAt              DateTime @default(now())
+    updatedAt              DateTime @updatedAt
+    firstName              String
+    lastName               String
+    isSuperAdmin           Boolean  @default(false)
+    professionalCompetence String?
+    utm_source             String?
+    utm_campaign           String?
+    utm_medium             String?
+    utm_term               String?
+    utm_content            String?
+    user                   User     @relation(fields: [userId], references: [id])
+    userId                 Int
 }
+
+model Project {
+    id        Int      @default(autoincrement()) @id
+    createdAt DateTime @default(now())
+    updatedAt DateTime @updatedAt
+    name      String
+    tickets   Ticket[]
+    teamId    Int
+    userId    Int
+    labels    Label[]  @relation(references: [id])
+}
+
+model Ticket {
+    id        Int      @default(autoincrement()) @id
+    createdAt DateTime @default(now())
+    updatedAt DateTime @updatedAt
+    sequence  Int
+    title     String
+    body      String
+    teamId    Int
+    userId    Int
+    Project   Project  @relation(fields: [projectId], references: [id])
+    projectId Int
+    labels    Label[]  @relation(references: [id])
+}
+
+// Supporting models
+model Label {
+    id         Int       @default(autoincrement()) @id
+    createdAt  DateTime  @default(now())
+    updatedAt  DateTime  @updatedAt
+    value      String
+    background String
+    foreground String
+    teamId     Int
+    projectId  Int?
+    boardId    Int?
+    isGlobal   Boolean   @default(true)
+    tickets    Ticket[]  @relation(references: [id])
+    projects   Project[] @relation(references: [id])
+}
```


